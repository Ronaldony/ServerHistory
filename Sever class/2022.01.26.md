# 2022.01.26 수업내용
## 네트워크
### L2 스위치(허브)
1. L2 스위치
    1) L2 정보(Mac 주소)를 가지고 스위칭해주는 장비
    2) 더미 허브(예전): 연결된 LAN선에 패킷을 모두 묶어서 보내는 Broadcast 효과가 난다. 
        * 더미 허브로 뿌려진 Frame에는 도착지 주소가 적혀있어 다른 장치에서 해당 도착지
        * 더미 허브의 단점: 묶여서 가는 만큼 속도가 줄어든다. 데이터 충돌이 일어난다.(때문에 Collision이라는 충돌 LED가 달려있다.)
    3) 스위치 허브
    4) Mac Table
        * 몇번 포트에 무슨 Mac 주소인지 저장하는 테이블
        * 포트당 개별적 통신 용량을 제공한다 
        * L2 스위치의 RAM 크기마다 Mac Table 크기가 달라진다.
    5) 일반적으로 L2 스위치의 포트를 무작정 늘리는 것은 잘못된 설계이다. 불필요한 통신으로 인하여 속도가 저하되기 때문이다.
        * Broadcast 방식으로 불필요한 통신을 줄일 수 있다.
    * OSI 계층에서의 L2 스위치는 목적지의 역할을 할 수 없는 L1의 장치로 보는 경향이 크다.

### L3 스위치(공유기)
1. L3 스위치 + NAT 기능을 가진 장치로 본다. 목적지로서의 역할을 할 수 있는 장치로 인식된다.
2. Frame 수신 시 공유기 장치안의 L3->L2 계층을 거쳐 다음 라우터의 L3 계층으로 이동한다. 이 동작을 반복
3. NAT 기능이 포함되지 않는 이상 Frame의 IP, TCP(포트) 주소는 바뀌지 않는다.

### L4
1. 여러 라우터(L3 스위치)를 거쳐 L4(서버 IP일 확률이 높음)에 도착한다. 도착 후 L4는 TCP 헤더의 포트 번호를 찾아 해당 프로세스와 연결한다.
2. L4 스위치는 로드 밸런서의 기능을 한다. 같은 기능을 하는 컴퓨터를 여러개 연결해두고 부하를 분산시킨다.
    * L4 스위치는 NAT 기능을 가져 목적지 IP주소를 연결된 컴퓨터로 바꾸어서 전달한다.
    * 왜 L4부터 로드 밸런서의 개념이 나왔나? => 각 TCP 연결, 세션 단위로 관리하기 위한 방법이다.
    * 연결이라는 것은 세션 기능을 말한다.
    * 이 로드 밸런서를 위하여 L4 스위치는 고가여야 함

### L7
1. L7 대부분이 HTTP 프로토콜 장치이다.
2. HTTP 헤더를 분석하여 막던가 받던가

### IP 헤더
1. 뻉뺑이 루프 도는 경우
    1) 초창기에 아무도 부여받지않는 IP를 가는 경우
    2) IP 설정을 잘못한 경우
2. TTL: 뺑뻉이 루프를 방지하기 위한 생존 기간. 라우터를 거칠 때마다 1씩 감소한다.
    * TTL이 0이 되면 발신자에게 ICMP 기능으로 응답을 전송한다.
    * tracert 명령어는 이 TTL을 1씩 증가시키며 ICMP로 폐기된 frame을 수신한 정보를 출력한다.    

## TCP/IP 프로토콜
### 인터넷 계층
1. ARP 스푸핑(ARP spoofing)
    1) 근거리 통신망(LAN) 하에서 주소 결정 프로토콜(ARP) 메시지를 이용하여 상대방의 데이터 패킷을 중간에서 가로채는 중간자 공격 기법이다.
    2) 네트워크 환경 관리자 측에서 ARP 스푸핑을 관리해줘야 한다.
2. ICMP
    1) 프레임의 오류를 검지하여 폐기 여부를 송신자에게 알려주는 프로토콜

### NAT
1. NAT는 주소를 바꿔치기하는 역할을 갖는다.

## 기타 키워드
### 허브
1. PPS: 초당 몇천만건의 패킷을 처리하는 용량

### 스위치와 라우팅
1. 스위치: 연결된 여러 장치의 스위치같은 역할(보내줄지 안보내줄지 정하는 역할)
2. 라우팅: 경로를 찾아가는 일련의 작업
3. L3 스위치는 라우터라고 보면 된다.

### 포트 번호
1. 0번 ~ 1023번: 잘 알려진 포트 (well-known port) => 여기서의 포트 번호는 서비스 서버쪽에서의 포트 번호이다.
2. 1024번 ~ 49151번: 등록된 포트 (registered port)
3. 49152번 ~ 65535번: 동적 포트 (dynamic port)
4. 서비스 주소가 하나(포트 번호 하나)

### 명령어 모음
1. arp -a: ARP 테이블 보기, arp [] []
2. route PRINT: 라우팅 테이블 보기
3. netstat: L4 계층(TCP, UDP 등)에서의 연결 정보 모니터링, netstat -an: 모든 포트의 외부 주소를 포트 번호로
4. tracert: 최종 IP까지의 경로(L3)를 추적하는 명령
    * 예시: 103.24.8.4(호스트웨이)
    * ping을 때렸는데 응답이 오지 않는다. => tracert 명령어에서 응답이 없는 구간이 있다!(뺑뺑이 루프) 또는 해당 구간에서 방화벽으로 막히고 있다!
    * 외국에서 서비스 시 해당 국가의 센터에 서버를, 주변 국가에서 해당 국가로의 ping 응답, tracert 경로가 짧은 것을 선택해야 한다.

### 랜카드를 많이 꽂는다는 것
1. 하나의 서버를 여러 LAN에 존재하게하기 위한 목적이 있다.
2. 보완 목적: DB는 공인 IP로 묶여서는 **절대** 안 된다. 때문에 게임 서버는 랜카드를 2개 이상을 두어 하나는 DB에 하나는 공인 IP(클라이언트와의 통신 목적 등..)에 연결하여, 사설 IP와 공인 IP를 분리하는 형태로 가져간다.
    * 더 자세히 들어가면 용도별로 LAN을 묶어 LAN 성능을 높일 수 있다.
3. 특이한 케이스
    1) Frame이 해당 네트워크 이름으로 나가지않고 게이트웨이로 간다. -> 해결 방법: 라우팅 테이블의 메트릭 순위를 조절해야한다.

### Ping
1. 보통 방화벽에서 외부로부터의 Ping을 막는다. Ping이 된다는 것은 L3 계층에서는 문제가 없다는 뜻이다.
    * Ping이 되지않는다 -> 방화벽부터 열어야 한다.(인바운드 규칙에서 ICMP-echo 추가)
