# Chapter10 동기 및 비동기 장치 I/O
## 들어가기에 앞서
### 동기와 비동기 I/O
1. 스레드가 동기적인 장치 I/O를 요청하면 I/O 작업이 완료될 때 까지 해당 스레드는 블로킹 상태가 된다. 이는 수행 성능에 나쁜 영향을 미치게 된다.
2. I/O 컴플리션 포트(aka IOCP): 매우 잘 정제된 스레드 간의 통신 매커니즘, I/O 수행 시 응답을 대기할 필요가 없다. 최초 IOCP는 장치 I/O에만 적용하게 설계되었지만, 시간이 지나면서 OS의 다양한 기능들을 하나하나 IOCP와 통합하였다.

## Section01 장치 열기와 닫기
### 장치의 특성
1. 본 책에 Page 389 표 10-1에서는 장치들의 각 특성을 표로 정리하였다.
2. 윈도우는 각 장치들 간의 차이점을 가능한 한 개발자에게 드러내지 않으려고 한다. 이렇게 함으로써 장치를 한 번 열기만 하면 장치에 대한 읽기, 쓰기를 수행하는 함수들은 장치의 종류와 상관 없이 동일하게 사용될 수 있다.

### 장치 열기 함수
1. 본 책에 Page 389 표 10-2에서는 장치들의 열기 함수들을 표로 정리하였다.
2. GetFileType
    <pre><code>
    // 입력한 핸들의 파일 타입을 반환해주는 함수                       
    // FILE_TYPE_UNKNOWN(0x0000) 반환 시 GetLastError()로 오류 코드를 확인할 수 있다.
    DWORD GetFileType(
        HANDLE hFile
    );
    </code></pre>
3. I/O의 캐시(임시 버퍼)를 없애면 해당 디바이스 드라이버

### CreateFile 함수
1. 플래그
    1) FILE_FLAG_OVERLAPPED: 해당 장치에 대하여 비동기적으로 I/O를 한다고 시스템에 알린다.

## Section03 동기 장치 I/O 수행
### 동기 I/O
1. hang 증상: 여러 원인이 있지만 그 중 동기 I/O에 의해 발생되기도 하는 현상. 시스템, 네트워크, 어플리케이션이 동작하지 않고 서비스가 응답하지 않는 상태
2. CancelSynchronousIO
    1) 기능: 지정한 스레드가 동기 I/O 작업의 완료를 대기하고 있었다면 해당 스레드는 수행을 재개하게 되고, 요청한 동기 I/O 작업은 실패하였음을 나타내는 값을 반환한다.
    <pre><code>
    BOOL WINAPI CancelSynchronousIo(
        HANDLE hThread
    );
    </code></pre>
    
## Section04 비동기 장치 I/O의 기본
### 비동기 I/O
1. 비동기 I/O 요청: 스레드가 비동기 I/O 요청 시 실제로 I/O 작업을 수행할 장치의 디바이스 드라이버로 전달된다. 이때 디바이스 드라이버가 장치로부터의 응답(처리)를 대기해 주기 때문에 L7의 어플리케이션은 I/O 요청 완료를 대기하지 않고 다른 작업을 계속 수행한다.
    * 디바이스 드라이버가 I/O 요청 작업에 대한 결과(송수신 완료 여부, 에러 발생 등)를 통지해 주는데 L7 단계에서 이 결과를 어떻게 처리해야할지 고민해봐야 한다.

### OVERLAPPED 구조체
