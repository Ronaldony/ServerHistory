# 2022/07/11 수업 내용
# Lan 서버
## Lan 서버
### Release와 Disconnect
1. 현재는 IO Count만 사용하여 Release를 호출하게 된다.
    1) 이것은 Recv, Send가 걸리지 않은 것만 알 수 있다.
2. Dsiconnect는 연결을 끊고 사용되지 않게끔 유도하는 것이다.
    1) 잘 만들어 볼 것

### SendPacket과 Release
1. 해당 세션이 Release와 SendPacket이 동시에 호출된 상황에서 벌어지는 문제
    1) 첫 번째 방법: Release가 안 되게 막아야 한다. 이를 구현하기 위해서는 참조 카운트 방식을 사용해야 한다. 즉 SendPacket에서도 IO Count를 증가시킨다.
        * 플래그는 안 된다.
        * IO Count가 세션 사용 카운트가 되는 것이다.
    2) 두 번째 방법: SendPacket과 Release 서로가 확인하여 하나의 동작을 중단하는 방법
        * Flag를 사용하는 방법: SendPacket 간에 혹은 SendPacket과 Disconnect 끼리는 동시에 들어와서 동작하여도 된다. 따라서 Flag는 Release가 되었는지에 대한 Flag로 사용되어야 한다.
    3) 
2. 코드
    <pre><code>
        SendPacket
        {
            세션 = 세션 ID 검색;
            
            // 아래 2가지 동작은 Atomic하게 동작할 수 없다. 
            // (1) IO Count는 Release를 막는 역할을 하게 된다.
            // (2) Release Flag를 확인하는 작업은 Release 동작에 영향을 주지 못한다.
            // 따라서 
            세션->IOCount++;
            Reelase Flag 확인 == 1;
            
            세션 사용;
            세션->IOCount--;
            if (IO
        }

        Release
        {
            // 아래 3가지 동작을 Atomic하게 Double CAS 혹은 변수의특정 변수를 통하여  사용해야 한다.
            IOCount 확인 == 0;
            Release Flag != 0;
            Release Flag = 1;
            ...
        }
    </code></pre>
3. 동기화 객체와의 비교
    1) 이득 볼 것이 있느냐? => 결론적으로는 없다. 우리의 서버에는 1만명 이상이 있을텐데 경합의 비율이 크게 없을 것이다.

### 기타
1. 포트폴리오에는 동기화 객체 사용 없이 네트워크 라이브러리를 제작했다는 것만 언급해야 한다. 성능적인 면에서는 이득이 없기 때문
