# 2022/04/13 수업내용
## TCP 파이터 서버 만들기
### 보완사항
1. 이전 기수와는 다르게 재연결, 연결 끊김을 감지하는 부분을 추가할 것이다.

### 서버 구조
1. 보통 서버가 싱글 스레드라고 하면 로직이 하나의 싱글 스레드로 구현되었다는 것이지, 네트워크 까지 같은 스레드라는 얘기는 아니다.
    * 언리얼의 경우 MO 형태여서 네트워크까지 싱글 스레드에 포함되지만 MMO는 절대 불가능하다.\
2. 서버 프레임을 몇으로 맞출것이냐?
    1) 프로그래머가 결정해야하는 사항이다. => 강사님은 보통 50, 60 프레임
    2) 프레임이 빨라지면 정교한 처리가 이루어진다 의 의미? => 게임 로직을 예로 들면 캐릭터의 이동, 충돌 처리가 클라에게 자연스럽게 표현된다.
        * 액션성이 강하거나 굉장히 부드러운 연출이 되어야하는 경우 프레임이 빨라져야함
    3) 3D 게임에서는 프레임에 기반한 로직이 아닌 시간을 기반한 로직으로 구현되어야 한다.
        * 프레임이 떨어질 수 있기 때문이다.(클라 측면)
3. 각 로직 파트의 프레임(멀티 스레드 환경)
    1) 네트워크 로직: 개별적으로 스레드를 빼게되면 프레임을 맞추지않고 최선을 다해 수행
    2) 컨텐츠 로직: 프레임에 맞춰 로직 수행

### 안전 장치
1. 서버는 함부로 종료하면 안됨, DB 저장이나 기타 등등 유저의 정보를 백업해놓아야 함
2. Server Control의 목적: 기획자, 클라이언트에게 제공하여 서버 테스트를 각자 개인이 할 수 있게 만들기 위한 목적!
    * 보통 회사에서는 기획자, 클라에게 각자의 서버를 두고 개발을 진행한다.
    * 사례1: 테스트 시 계정 인증 등의 절차를 무시하고 하기 때문에 이러한 부분을 제어
    * 사례2: 라이브 서비스 중 갑작스럽게 디버깅이 필요할 때 서버 컨트롤을 통해 제어 (예전 강사님은 하나의 플레이어가 여러 맵에 존재하는 유령 플레이어 문제가 발생하였을 때 이 문제를 해결하기 위해 서버 컨트롤에 유령 플레이어 재현한 함수를 삽입하여 특정 상황마다 사용하였다.)

### 로그
1. 로그는 최후의 디버깅 방법이다.
2. 로그는 무조건 콘솔이 아닌 파일로 저장하는 형태가 되어야 한다. 네트워크 등 다른 곳에 전송하는 것은 데이터 유실의 가능성이 있기 때문에 배제시킨다.
3. 정상적으로 동작된 로그를 남기는 것도 중요하다. => 에러가 발생하였을 때 정상적인 루트가 어디까지 진행되었는지 파악할 수 있기 때문이다.
4. 로그 레벨
    1) 로그 레벨 변경: 실시간으로 로그 레벨을 변경하기 위하여 Log 함수를 만들어 레벨을 입력받아 로그를 남기는 형태로 만든다.

### 가변인자
1. 가변인자는 하나하나 알지 못한다. 가변인자 함수를 사용하여 List 형태로 받아와야 사용된다.
    * VA PRINTF,
2. 가변인자는 cdecl 호출규약이 사용되어야 한다. 함수 안짝에서 매개변수 개수를 몰라 스택을 정리할 수 없기 때문이다.

### 유저 접속
1. 유저 접속은 무조건 최선을 다해서 해야한다. 예를 들면 소켓 셋 등록시 항상 Listen 소켓을 등록한다.
2. 유저 끊김 기준
    1) recv가 0일 때
    2) 소켓 에러가 발생한 경우
    3) Timeout 처리
    * 소켓을 순회하는 동안 위 3가지 상황 발생에 대한 대처 코드 넣기

### 기타
1. 섹터(=클러스터, 파티션) 관리: 플레이어 시야에 대한 관리
2. 렉: 반응이 느리게 오는 것

## 기타 키워드
### C++ 문법
1. boost는 몰라도 됨(신입에게 요구한다는 것은 그 회사에서 boost를 위주로 사용한다는 것!) 요구하는 회사는 안 가야됨

### STL
1. STL 컨테이너는 map 이든 unordered 이든 iteraotr로 연결되어 있다. (우리가 만들때와는 다름, 해시 테이블의 순회 단점을 보완)
