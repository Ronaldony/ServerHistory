# Chapter09 스케줄링 알고리즘과 우선순위
## Section01 프로세스의 스케줄링
### 일반 OS와 리얼타임(Real Time) OS의 차이점
1. RTOS와 일반 OS의 차이점은 응답성(응답속도)에 있다.
  * RTOS는 범용적 용도의 일반 OS와는 달리 특수한 목적을 가지고 설계된다. 따라서 특수한 동작에 대하여 응답성이 일반 OS보다 빠르다. 하지만 이것은 RTOS가 더 빠르다는 이야기는 아니다.

### Soft RTOS vs Hard RTOS
1. Hard RTOS: 응답의 데드라인 존재한다. 이는 항공, 핵발전소, 자동차 등 안전과 관련한 분야에 사용된다. 이를 위해서는 일반 OS와는 전혀 다른 알고리즘의 스케줄러의 디자인이 필요하다.

### 선점형 OS와 비선점형 OS
1. 선점형과 비선점형 OS 비교
    1) 선점형 OS
        * CPU 선점: 우선순위가 높은 프로세스가 CPU를 선점한다.
        * 장점: 인터렉티브한 프로그램 구현 시 프로그래머의 의존도가 적다.
        * 단점: 기아(Starvation) 현상이 일어날 수 있다.(기아 현상: 우선순위가 낮은 프로세스가 CPU를 선점하지 못하는 현상)
        * windows는 선점형 OS 이다.
        * 스케줄링 알고리즘엔 우선순위 스케줄링과 라운드 로빈(Round-Robin) 스케줄링 등이 있다.
    2) 비선점형 OS
        * CPU 선점: 우선순위와 상관없이 프로세스의 CPU 할당 시간 만료 혹은 블로킹 상태가 되면 스케줄러에 의해 선정된 프로세스가 CPU를 선점한다.
        * 장점: ~?
        * 단점: 인터렉티브한 프로그램 구현 시 프로그래머의 의존도가 크다.

### 우선순위(Priority) 스케줄링 알고리즘
1. 설명: 스케줄러에 의해 **우선순위가 높은** 프로세스가 CPU를 선점하는 방식의 스케줄링이다.
2. 우선순위 스케줄링의 특징으로 인하여 **기아** 현상이 일어날 수 있다. 하지만 대부분의 프로그램이 I/O 작업에 상당한 시간을 할애하기 때문에, 기아 현상은 잘 발생하지 않는다.

### 라운드 로빈(Round-Robin) 스케줄링 알고리즘
1. 설명: 각 프로세스들에게 일정 CPU 선점 시간을 부여한다. 시간이 만료하면 우선순위가 동일한 다른 프로세스에게 CPU의 할당을 넘기는 방식의 스케줄링이다.
2. Quantum 혹은 Time Slice: 실행의 최소 단위 시간 간격
    * 다른 프로세스에게 CPU의 할당을 넘길 때 Time Slice를 기준으로 한다.
    * 최소 시간 간격이 길면 인터렉티브 시스템에서 문제가 될 수 있고, 짧으면 컨텍스트 스위칭이 자주 발생하여 성능에 문제가 될 수 있다.

### 스케줄링 알고리즘에 의해서 스케줄링이 진행되는 시점
1. 스케줄러가 동작하도록하는 세 가지 시점
    1) Case 1: 라운드 로빈 방식의 관점이다. 매 Time Slice마다 스케줄러 동작  
    2) Case 2: 우선순위 방식의 관점이다. 프로세스가 생성 및 소멸될 때 스케줄러 동작
    3) Case 3: 현재 실행중인 프로세스가 블로킹 상태에 놓일 때 스케줄러 동작

### Priority Inversion
1. 설명: 프로세스의 우선순위가 뒤 바뀌는 현상을 말한다.
2. Priority Inversion 예시(1-N은 순차적인 상황의 전개이다.)
    1) 프로세스 A, B, C가 있을 때 우선순위는 A > B > C이다.
    2) A가 CPU를 선점한 상태에서 C의 결과가 필요하여 블로킹 상태가 된다.
    3) 스케줄러에 의해 B가 CPU를 할당받는다.  => 이 때, B가 무한히 실행되는 프로세스라면 시스템에 문제가 생긴다.
    4) 일시적으로 C의 우선순위를 A의 우선순위가 같게 한다.   => Priority Inversion
    * 보통은 A가 C에게 우선순위를 잠시 위임하고 블로킹 상태에 빠진다.

## Section02 Windows 프로세스 우선순위
### 프로세스 우선순위
1. Windows는 우선순위를 6단계 계층을 제공한다.
    |우선순위 계층|의미|
    |------|---|
    |IDLE_PRIORITY_CLASS|기준 우선순위 4|
    |NORMAL_PRIORITY_CLASS|기준 우선순위 9|
    |HIGH_PRIORITY_CLASS|기준 우선순위 13|
    |REALTIME_PRIORITY_CLASS|기준 우선순위 24|
    |ABOVE_NORMAL_PRIORITY_CLASS|NORMAL..과 HIGH의 중간 기준 우선순위|
    |BELOW_NORMAL_PRIORITY_CLASS|NORMAL..과 IDLE의 중간 기준 우선순위|
2. 관련 함수
    1) 프로세스의 우선순위 변경
        <pre><code>
        BOOL SetPriorityClass(
            HANDLE hProcess,        // 우선순위를 변경 시킬 프로세스 핸들
            DWORD  dwPriorityClass  // 우선순위 계층 값
        );
        </code></pre>

## Section03 명령 프롬프트 프로젝트 기능 추가
* 구현 내용: Chapter08에서 구현한 기능에 더하여 "리다이렉션"과 "sort" 명령을 추가한다.
* 코드 파일 경로: prj_prompt/chapter09
