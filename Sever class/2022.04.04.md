# 2022/04/04 수업내용
## 길찾기
### 클라이언트의 Navimesh
1. 폴리곤 형태로 그리드를 만들어 길찾기를 하는 방법이다.(우리가 구현한 네모난 그리드 모양의 길찾기왕 동일하다. 그저 도형이 네모가 아닌 폴리곤 형태인 것이다.)
2. 어려운 문제는 클라에서 폴리곤 형태를 길찾기하는 것이 아닌 길찾기가 완료된 좌표를 네모난 그리드 형태로 변환하여 서버에 전달하는 것이 어려운 문제이다.

### 3D 차원에서의 길찾기
1. 복셀 타일: 그리드를 3차원 도형으로 모델링한 형태이다. 이 방법을 사용하는 이유는 모든 폴리곤 형태의 길찾기를 커버하기 위한 방법의 타일이다.
  * 검은사막이 이를 활용하여 복셀을 사용한다.
  * 일반적인 게임에서는 중간에 장애물이 있으면 높이가 어떻든 공격하지 못하게 한다.
  * 복셀 타일로 맵을 구현하면 굉장히 많은 용량이 들어간다.
2. 폴리곤 형태를 3차원 복셀로 모델링하면 훨씬 더 복잡해진다.
3. 서버에서의 복셀 타일을 사용하는 이유
    1) 최대 목적은 충돌처리이다. 예를 들어 2차원 타일 형태에서 A가 B를 화살을 쏘려고 하는데 중간에 벽이 있다. 이 벽은 일정 높이를 가지고 있다. 이때 A가 쏜 화살이 벽에 부딪힌 경우 공격이 사라지고 넘어간 경우 맞추어야 하는 것을 구현해야하는 경우에 사용해야 한다.
        * 만약, 오브젝트(장애물 등)마다 충돌처리가 가능하냐 불가능하냐의 판단이 들어가게되면 애초에 오브젝트가 수학적으로 계산되어있기 때문에 굉장한 부하가 일어나게 된다.
        * 실제적인 구현: A가 쏜 화살의 경로(포물선)에 복셀 타일이 충돌되는지 확인

## Jump point search(JPS)
### 에이스타와 의 Jump point search
1. 에이스타는 불필요한 노드(타일)가 많이 생성된다. 이를 개선하기 위한 방법이 JPS이다. JPS는 애초에 불필요한 노드를 생성하지 않는다. 결론적으로는 에이스타에서 노드 생성 규칙만 바뀐 형태이다.
2. JPS에서는 G를 부모를 기준으로 값이 생성되지 않고 목표 지점을 기준으로 계산되어 결정된다.

### Jump point search의 타일 생성
1. Jump point search는 어디에 노드를 만들까~를 고민해야 한다.
    1) 뚫린 길이 아닌 코너(갈림길)를 찾아 노드를 만든다. 하지만 코너를 찾는 것은 노드를 생성하지 않을 뿐이지 탐색은 해야한다. 만약 잘못 만들면 오히려 에이스타보다 성능이 더 떨어진다.
        * 부모의 방향은 이미 부모가 탐색하였다고 판단을 하고 내가 나아가야 할 방향을 기준으로 코너를 탐색한다.
2. 코너를 판단하는 기준(방향별 코너찾는 방법)
    1) 수직 수평: 나아가는 방향이 오른쪽이라고 한다면, 위아래에 벽이 있고 위아래 대각선에 벽이 없는 경우 해당 지점에 타일을 생성한다.
    2) 대각 방향: 나아가는 방향이 오른쪽 위 대각선이라고 한다면, 왼쪽 아래가 막혀있고 왼쪽 위 대각선 오른쪽 아래 대각선 방향이 뚫린 경우 코너라 판단한다.
    * 하나의 타일은 앞으로의 코너를 찾고 다음 자식 타일에 의무를 이전한다.(1부모-1자식)
3. 수직 수평, 대각선 방향의 코너 탐색 영영
    1) 처음 탐색 시작에는 8방향 모두 검사한다.
    2) 수직 수평은 타일을 기준으로 상하 좌우만 커버한다.
    3) 대각선 방향은 수직 수평 타일이 커버하는 곳을 제외한 나머지 영역을 모두 탐색해야 한다. 그러기 위해서는 대각선 탐색 방향마다 자신의 자리 체크, 수평 수직을 체크해야 한다. 예를 들어 오른쪽 대각선이라면 위, 오른쪽 수평 수직을 검사한다. 이후 수평 수직에서 코너를 발견한 경우 그 자리에 타일을 생성하는 것이 아니라 탐색을 시작한 대각선 방향 지점에 타일을 생성해야 한다. 이유는? 만약 코너 지점에 타일을 생성하면 맨~처음 탐색을 시작한 지점에서 해당 타일로 갈 수 있는 방법이 없기 때문이다.
        * TOOD: 그림 추가할 것
4. 타일 생성 시 유의 사항
    1) 수평 수직 방향: 모든 타일은 필요에 의해 생성된 것이다. 코너라는 의미이다. 예를들어 오른쪽 방향 및 아래 방향 코너 타일이 있을 때 오른쪽 방향(기본)과 오른쪽 아래 대각선 방향(자신이 만들어진 이유의 방향)으로 탐색을 시작한다. 2방향의 Jump라고 한다. 최대 3방향이다. 따라서, 자신이 어느 코너에 있는지 판단하여 나아가야 할 방향을 결정해야 한다.
    2) 대각선 방향: 대각선은 자신이 나아가는 방향, 수평, 수직 방향으로 기본 3방향이다. 만약 오른쪽 아래 대각선 방향이라면 오른쪽, 아래, 오른쪽 아래 방향을 기본으로 탐색한다. 그리고나서 자신이 코너인 경우 추가적으로 왼쪽 아래, 오른쪽 위 방향 대각선으로 Jump한다. 그래서 최대 5방향이다.
    3) 이미 검사가 완료된 타일은 다른 방향에 의해 탐색되지 않는다. 예를 들어 오른쪽 아래 방향으로 탐색한 타일은 오른쪽 수평 방향을 검사할 때 앞서 탐색된 타일을 검사하지 않는다.

### 구현
1. 각 노드들이 탐색한 지역을 다른 색상으로 칠하여 구분이 가능하게 해야한다.
2. 해당 길찾기를 라이브러리로 따로 떼어내기 위해서는 렌더링 부분을 제거하는게 들어가야 한다.
    1) 렌더링이 추가된 길찾기와 렌더링이 제거된 길찾기 두 개를 놓고 OpenList, CloseList, 생성된 노드 및 노드의 정보, 최종 경로를 비교하면서 같다면 검증하였다고 판단할 것이다. 

### 시험(코스 테스트)
1. 모든 노드가 만들어진 이유를 설명할 줄 알아야 한다.

### Picking
1. 3D 게임에서 화면상에서 유저가 지정한 것을 알아내는 작업

## 기타 키워드
### 몬스터 AI
1. 대부분 몬스터 AI는 굳이 길찾기 알고리즘을 사용하지 않는다. 대부분 단순한 직선이동을 하여 장애물을 만나면 방향 전환 등을 하는 정도의 AI 구현을 한다.
