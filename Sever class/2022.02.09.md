# 2022/02/09 수업내용
## 네트워크
### Ping
1. 포트 지정을 하지않은 Ping 패킷이 어떻게 발신자에게 돌아오는 것일까?
    * IP 헤더에 ID를 읽어 패턴을 해석하여 발신자의 위치를 맵핑시켜 파악한다.
    * IP 헤더의 ID 정보는 단편화된 혹은 되지않은 패킷이 같은 패킷인지 구별하는 용도로 사용된다.

### VPN
1. VPN은 물리적인 형태를 가진 장비이다.
2. VPN 과정
    1) 내 PC가 VPN 서버에 접속한다.(하마치 VPN 서버가 유명)
    2) VPN 서버가 제공하는 IP(공인 혹은 사설)가 내 PC에 VPN 이더넷 인터페이스로 생성됨 (라고 강사님이 말하셨지만 실제로는 이더넷 인터페이스에 생성되지 않는다.)
    3) 내 PC에서 WAN을 거쳐 다른 유저에게 데이터를 보내거나 받을 때, 항상 VPN 서버를 경유하여 전달된다. => 때문에 내 PC와 통신하는 측은 내 PC의 IP를 VPN 서버가 제공한 IP로 본다.
    * VPN 사용 시 VPN 연결용 이더넷을 설치해야함. 내 PC에 이더넷의 역할을 VPN이 하기 때문이다.
3. 용도
    1) 사내 서버, DB, 장비 등은 NAT 및 방화벽이 설치되어 외부에서 내부로 들어오는 것을 차단할 것이다.
    2) 이 때 사내에 VPN 서버를 설치한다.(VPN 서버는 WAN과 LAN 환경이어야 함)
    3) 임직원이 VPN 서버에 접속하기 위해 ID, 비번, 사설 IP를 지정받아 로그인한다.
    * 요즘은 VPN 서버는 NAT 및 방화벽의 기능도 겸한다.
4. VPN 프로토콜 패킷 구조
    1) IP헤더, TCP헤더, 데이터를 VPN 프로토콜이 감싸게 된다. VPN 프로토콜엔 새로운 IP 헤더가 붙는데 송신처 IP가 VPN 서버로 지정된다. 
5. VPN 기능은 VPN 프로토콜을 지원하는 OS에서만 사용이 가능하다.
* L3에서는 VPN, L7에서는 프록시 구조로 대응된다.
* 프록시의 경우 보통 HTTP 프록시로 사용되며, HTTP 내용을 분석하여 나온 재요청 IP(리다이렉트)에 클라가 다시금 요청을 하는 형태이다. 이러한 구조로 인해 L7에서의 수행 동작이다.

### 포트 포워드
1. UPNP: 프로토콜로 포트 포워드 테이블을 여는 기능. 내부에서 UPNP 규격으로 공유기에 쏘면 자동으로 포트 포워딩 테이블을 생성하는 기능(공유기에도 있음)

## 도메인
### 도메인
1. 도메인은 '.'을 기준으로 상하위 관계가 정해지므로 DNS 서버에 도메인을 등록하여야 한다.
    * ex: abc.kr => kr DNS 서버에서 abc주소가 있음.
    * 내 PC에 등록된 DNS 서버에 새로 등록한 도메인이 등록
2. DNS서버에 도메인 등록 과정 (예시 www.abc.com)
    1) com 찾기: '.' route DNS서버에 요청한다.(모든 DNS 서버에는 '.'가 등록되어 있다.
    2) abc 찾기: 
3. TTL: 86000초(24시간) 동안 내 PC에 등록된 DNS 서버에 캐싱을 해놓는다. 이 시간동안 IP가 갱신되어도 DNS서버에 등록되지 않는다.
4. '.'을 기준으로 4개 까지 입력하는 것을 추천한다. (물리적으로 분리된 공간에 대한 주소)
5. 클라이언트 코드에는 도메인으로 서버에 접속한다.
* ISP 업체에서 DNS 서버를 제공해준다.

### 관련 명령어
1. nslookup: DNS 서버에 등록된 도메인 IP 보기
    * DNS 서버측에서 도메인 IP 주소를 뺑뺑이 돌리는 이유: 보통 클라이언트측에서 getaddrbyname 함수로 얻은 IP 리스트 중 첫 번째 주소만 사용하기 때문.
    * DNS 서버 설정을 통해 도메인에 등록된 IP를 다 줄것인지 하나만 줄것인지 결정할 수 있다.
2. ping [도메인] 시 일정 시간 동안 같은 IP로만 요청하는 이유
    * PC 내에서 자체적으로 DNS에 요청하여 얻은 IP를 캐싱하여 이 정보를 때문
    * 바꾸는 방법: ipconfig /flushdns
3. ipconfig /displaydns: 내 PC 캐시에 등록된 도메인 IP 번호들 출력

## 기타 키워드
### 웹 방화벽: L7 방화벽
