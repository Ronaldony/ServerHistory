# 2022.01.28 수업내용
## 네트워크
### 레이턴시
1. 네트워크 레이턴시: 국내 네트워크 + 국내 서버 서비스 시 네트워크 레이턴시가 없다고 본다. (대략 4~5ms 이지만 인간이 느끼지 못함)
2. RTT(Round Trip Time): 출발 시간부터 도착지에서 돌고 출발지에 다시 도착하는 시간 (일반적으로 L7 양쪽 끝단을 기준으로 사용됨.)
    * 다른 서비스 서버와 달리 게임 서버에서 **RTT가 길어지는 이유는**, 특정 목표 FPS에 따라 모든 요소(적 리스폰, 적, 캐릭터 등)의 처리가 이루어져야 하기 때문이다.

### MAC 헤더
1. 1% 네트워크에서는 MAC 헤더는 L3 에서 만든다고 언급한다. 그 이유는 MAC 헤더에는 ARP 프로토콜, IP 프로토콜 등의 타입 정보가 들어가기 때문이다.
    * 하지만 강사님은 L2 계층에서 만들어진다고 판단한다. 그 이유는 차후에 설명...
2. 모든 OS는 네트워크 프로토콜을 따르지만 구현 방법이 다르기 때문에 실제적인 동작이 **각기 다 다르다.**
    * 때문에 어떤 것이 맞다보다는 **우리의 환경**에서의 이해를 바탕으로 가져가야 한다.

### IP 헤더
1. MTU(Maximum Transmission Unit): 일반적으로 L3 라우터의 최대 프로토콜 데이터 단위의 크기이다. 현재는 1500 Byte이다. 
    * 이를 정해놓은 이유는 모든 네트워크 장치가 서로 정상적으로 통신하기 위함이다.
    * 크기를 키우려해도 현대 모든 네트워크가 이미 같은 크기로 설정되어 있기 때문에 크기가 어렵다.
2. L3 계층에서는 분할된 패킷 개념이 나온다. 이는 IP 헤더의 ID 정보, 플래그에 의해 판단된다. MTU를 넘기면 Pcket을 쪼개어 보낸다.
    * 쪼개는 것이 위험하다는 입장의 주장은 맨 앞 Playload 헤더가 붙기 때문에 해당 Frame이 유실되면 유실율이 x배 증가하게 된다.
    * 유실율을 줄이는 방법: 애초에 Packet을 쪼개고 각각의 IP 헤더에 ID 정보, 플래그를 저장하여 보내 목적지에서 판단하게 한다.
3. 가변 길이로 설계되어 있지만, 보통 IP 헤더는 20byte이다.

### TCP 헤더
1. MSS: IP헤더의 MTU와 대응하는 크기. TCP 계층에서의 전송 최대 크기이다. 보통 1460(MTU - IP헤더 20 - TCP 헤더 20)
2. 시퀀스: L3에서 Frame의 출발과 도착 순서가 뒤바뀌어 오는 경우가 있기 때문에, TCP 계층에서 바로 잡기 위해 부여한 필드이다. 송신측에서 수신측으로 전송한다.
    * L3는 여러 라우팅(메트릭)을 거치기 때문에 순서가 바뀔 수 있는 것이다.
    * 바이트 단위 크기로 증가하여 해당하는지 확인을 한다.
3. ACK: TCP 기능 중 재전송 기능을 위한 필드이다. 수신측에서 송신측으로 어디까지 받았는지 시퀀스 번호를 담아서 보낸다.
    * 수신 측
4. 컨트롤 비트: 통신 제어의 의미를 가진 정보를 담는 필드이다. (ACK, SYN 등..)
5. 윈도우: 나의 수신 버퍼를 송신의 주최가 호스트에 알려준다(현재는 최대 64KB). 상대방 호스트의 상태를 파악하기 위하여 존재하는 필드이다.
    * 이 값을 기준으로 송신 호스트가 수신 호스트의 수신 버퍼 상태를 확인하여 패킷을 보낼지 말지를 결정한다.
    * 이 윈도우 떄문에 TCP에서는 DDOS 공격이 불가능하다.
    * SYN 플루팅: SYN 패킷만 보내어 TCP 연결 기능을 마비시키는 공격
    * 윈도우 스케일: 현재 네트워크 환경에서 윈도우 크기가 너무 작기 때문에, 윈도우 사이즈에 몇승 크기로 인식하여라 라고 송신측에 알리게끔 추가한 필드이다.
6. 가변 길이로 설계되어 있지만, 보통은 TCP헤더는 20byte이다.

### 데이터 유실
1. 모든 계층에서는 데이터가 유실될 수 있다. 그 이유는 각 계층간 통신 시 전달되는 데이터(Frame) 저장 최대 버퍼가 정해져있기 때문에 버퍼 초과 시 해당 Frame을 폐기한다.
    * 각 네트워크 계층은 비동기로 설계되어야 한다.
    * L2-4 스위치에서도 저가이면 유실이 된다. 유실되는 패킷을 모니터링하는 프로그램을 지원한다.
2. 한 컴퓨터에서 루프백(서버와 클라이언트) 통신을 하는 경우 L3에서 Dest IP를 보고 L7으로 Frame을 다시 올려보낸다.
    * 루프백 통신은 패킷 캡처가 되지 않는다. 패킷 캡처는 이더넷 드라이버를 통해 이더넷(L1) 신호를 캡처를 하기 때문이다.
    * 루프백에서도 Frame 유실이 많이 일어난다.
3. 모든 계층에서 Frame을 폐기할 때 알려주지는 않는다. (L3에서는 ICMP)

### 명령어
1. ping에서 출력되는 시간=xms는 L3 계층에서의 RTT이다.
    * 게임 레이턴시와 ping 레이턴시 구분 헷갈리지 않기!!

## 기타 키워드
### 레지스터에서 연산을 하는 이유
1. 물리 메모리에서 애초에 연산 기능 자체가 없기 때문이다. 컨트롤 버스에 전달하는 명령 자체도 없음
    * 연산 기능을 추가한다고해도 속도가 너무 느리기 때문에 비효율적이다.
    * 읽는 작업과 연산 작업을 분리

### Frame
1. 모든 프레임은 최대 크기가 정해져 있다.
    * 점보 프레임: 컴퓨터 네트워킹에서 점보 프레임은 1500바이트 이상의 페이로드를 지닌 이더넷 프레임
