# 2022/02/28 수업내용(복습 완료)
## 실습 관련
### 개발 시 확인해야할 사항
1. 서버에서 데이터의 동기화가 이루어지고 있는지가 필요하다.

### 서버-클라 간의 프로토콜 설계
1. 유저의 접속 절차
    1) 클라->서버 | 로그인
    2) 서버->클라 | 생성(캐릭터, 위치 등..), 이때 유저를 구분하기 위한 구분자가 있어야 한다. (강사님은 새로 생성하는 것을 선호함)
        * 만약 구분자가 유일한 고유 번호로 부여하면 유저의 행동 시점을 정확히 특정하기 힘듦
        * 배열 인덱스: 사람에 대한 구별이 안됨
    3) 서버->클라 | 다른 유저의 접속, 모든 클라에게 새로 접속된 유저(캐릭터 정보 등)를 생성해야 한다.
        * 이래서 처음 접속 시 제일 많은 리소스가 생성된다.
    * <img width=600 src="https://user-images.githubusercontent.com/95362065/155989214-3d79a707-ce0e-4529-87b5-85403efe9105.png">
2. 유저의 이동 및 목적지
    1) 클라의 일방적인 이동: 클라->서버에게 일방적으로 어디로 이동하여 어디로 도착했다라는 결과를 건네주고 서버는 그것을 그냥 받아들인다.
        * 실무에서는 절대 이와 같은 방법은 사용하지 않는다.
    2) 일반적인 상황: 클라가 목적지를 서버에게 보내고 이 목적지에 대한 평가 및 계산이 이루어지고 그 결과를 클라에게 이동 좌표를 보내준다.
3. 메시지의 방향성
    1) 방향성의 용도는 서버와 클라 중 어디서 보낼 수 있는 메시지인지 혹은 서버클라 어느쪽의 메시지인지 구분하기 위한 것이다.
4. 더미 클라이언트에서는 메시지에 "내가 누군데(ID)"를 담아 보낸다. 이는 실전에서는 절대 실어서 보내지 않는다. 서버에서는 이미 IP/포트 등의 정보로 해당 클라를 구분하고 있기 때문이다.
    * 이는 서버의 상태를 검증하기 위한 것일 뿐이다. 클라와 통신 시 디버깅하는 용도일 뿐이다.
    * 멀티스레드 환경에서는 엉뚱한 곳으로 보내지거나 받기때문에 이러한 구분자로 우리의 로직을 검증하기 위함이다.

### 게임의 종료
1. 클라가 정상으로 종료하던 비정상으로 종료하던 모두 비정상 종료로 간주하고 처리한다.

### 동작의 종속 관계
1. 동작의 종속 관계를 되도록이면 없애는 것이 좋다.
    * 동작: ID 할당, 별생성(본인), 별생성(다른 유저) 등..
    * 이는 메시지에 따른 종속관계이기도 하다.

### 메시지의 전달
1. 서버에서는 이동 좌표를 보낸 A유저를 **제외한 나머지 유저에게** 이동 좌표 메시지를 보낸다. 만약 A 유저에게 메시지가 전달된다면 A 유저는 과거의 좌표로 이동된다.
2. 서버로 전송하는 시점은 유저의 행동이 변화가 있을 때이다.

### 마샬링
1. 의미: 직렬화된 메시지를 용도에 맞게끔 변환하는 것. 특정 메모리에서의 표현방식을 저장 또한 전송에 적합한 다른 데이터 형식으로 변환하는 과정
2. 응용 사례: 각 메시지 프로시저 함수의 매개변수 통일함으로서 프로시저 함수 내부에서 마샬링을 사용하여 각 메시지에 적합한 처리를 할 수 있다.

## 기타 키워드
### 입력
1. 콘솔 입력과 키보드 입력은 다른 것이다.

### 키보드 조작
1. 프레임 단위로 동기화하는 것: 락스텝
2. 문제점: 목적지가 없는 것이 문제이다.
    * 해결 방법: 더미를 임시 목적지로 지정한다.

### 로그인 인증
1. 문제 상황: 유저가 자신의 **해시된 비번**을 서버에게 전송하여 DB에 저장된 정보를 통해 인증 절차를 진행하겠다.
2. 해결: **해시된 비번**을 보내는 것이 아닌 **비번 원본**을 보내야 함
3. 비밀번호는 대칭키 암호화, 비대칭키 암호화, DPR 등의 기법을 사용하여 숨긴다.

### RTT
1. RTT가 생기는 이유중 하나는 서버와 클라의 서로 다른 FPS 때문인 경우도 있다.
